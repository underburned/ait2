# Технологии искусственного интеллекта. Семестр 2

© Петров М.В., старший преподаватель кафедры суперкомпьютеров и общей информатики, Самарский университет

## Лекция 3. Клиент-серверное приложение с использованием Docker

### Содержание

1. [Введение](#31-введение)
2. [Клиентская часть](#32-клиентская-часть)
3. [Серверная часть](#33-серверная-часть)

### 3.1 Введение

Источники:
- 1

#### Постановка задачи

Цель &ndash; создание клиент-серверного приложения удаленной обработки данных.  
В качестве тонкого клиента приложения будет выступать десктопный графический интерфейс, реализуемый с использованием фреймворка Qt (PyQt6). Данное приложение должно реализовать следующий функционал:
- загрузка исходных данных (например, изображения) и их отображение в GUI
- передача загруженных данных на сервер для последующей обработки
- получение обработанных данных
- вывод пользователю сообщения о завершении обработки и отображение результатов в GUI

Серверная часть должна реализовать следующий функционал внутри докер-контейнера:
- прием данных на обработку
- обработка данных
- передача обработанных данных обратно клиенту  

Концептуальная схема приложения изображена на рисунке 1.

<div align="center">
  <img src="images/client_server_docker_app_1.svg" width="1000" title="Client-server app architecture"/>
  <p style="text-align: center">
    Рисунок 1 &ndash; Концептуальная схема приложения
  </p>
</div>

Взаимодействие между клиентом и сервером должно осуществляться в асинхронном режиме. Для этого будет использоваться ***брокер сообщений***, экземпляры которого будут общаться через SSH туннель. Более подробная схема изображена на рисунке 2.

<div align="center">
  <img src="images/client_server_docker_app_2.svg" width="1000" title="Client-server app architecture"/>
  <p style="text-align: center">
    Рисунок 2 &ndash; Схема взаимодействия основных модулей
  </p>
</div>

#### Библиотеки

Для работы нам понадобится установка библиотек.

Клиент:
- dramatiq
- numpy
- opencv-python
- pyqt6
- sshtunnel

Команда:

```bash
pip install dramatiq[redis] numpy pyqt6 sshtunnel
```

Для работы `sshtunnel` нужен установленный OpenSSH.
> Linux: нужно поставить дополнительно либы:
> ```bash
> sudo apt install libffi-dev libssl-dev python-openssl
> ```
> P.S.: возможно, пакет `python-openssl` здесь лишний.

Сервер (внутри образа контейнера):
- dramatiq
- numpy
- opencv-python
- ...

Рассмотрим каждый из модулей по отдельности.

### 3.2 Клиентская часть

[Введение в Qt](qt_intro.md)

[TBD]:
- GUI модуль: схема, описание, `GUI и worker threads` (Введение в Qt)
- `SSHTunnelForwarder` из `sshtunnel`
- `dramatiq`
- `redis`: `RedisBroker`, `RedisBackend`

### 3.3 Серверная часть

[TBD]:
- `dramatiq`
- `redis`: `RedisBroker`, `RedisBackend`
- докер-файл с конфигурированием `redis`